This R script is a complete pipeline for using animal tracking data (specifically for frigatebirds) with satellite-derived chlorophyll-a concentration data from MODIS Aqua, and visualizing the results. Below is a detailed breakdown of what the code is trying to accomplish:

ðŸ§­ ðŸ“Œ Purpose
To annotate GPS movement tracks of frigatebirds with environmental data (chlorophyll-a concentration) and visualize the enriched tracks.
This allows researchers to examine relationships between animal movement and ocean productivity â€” e.g., to understand foraging behavior relative to chlorophyll hotspots (which indicate high primary productivity).

ðŸ§± Step-by-Step Explanation
1. Load Required Libraries
Packages for data handling (dplyr, lubridate), mapping (ggplot2, viridis), geospatial operations (raster, sp), and environmental data retrieval (rerddap, rerddapXtracto).

2. Load Frigatebird Track Data
r
Copy
Edit
frigatebird.tracks <- readRDS(...)
Loads a cleaned RDS file of GPS-tracked frigatebird movement data.

Fields: LocationLat, LocationLong, Timestamp, TagLocalIdentifier, etc.

3. Define Spatial & Temporal Extents
r
Copy
Edit
extent_to_download
dates_to_download
These determine the bounding box and date range of the tracking data to limit the satellite data download to the relevant region and time window.

4. Download Chlorophyll-a (MODIS)
r
Copy
Edit
CHL <- rerddap::info(...)
chl <- rxtracto_3D(...)
Uses rerddapXtracto to download MODIS Aqua chlorophyll-a concentration data for the defined space and time window.

Retrieves sea surface chlorophyll, a proxy for marine primary productivity.

5. Tidy Chlorophyll Data
r
Copy
Edit
chl_tidy <- tidy_grid(chl)
chl_tidy$MonthDate <- floor_date(...)
Converts downloaded NetCDF into a long-format data frame.

Adds a new column MonthDate to simplify time-matching with tracking data.

6. Load Chlorophyll Raster File
r
Copy
Edit
chl_stack <- stack(...)
Loads .nc raster layers for chlorophyll â€” each raster layer corresponds to a specific date.

chl_stack is used for spatial extraction (i.e., interpolating raster values at GPS point locations).

7. Build Date Lookup Table
r
Copy
Edit
DateTable <- ...
Cleans raster layer names to standard date format.

Creates a table matching each raster layer with a calendar month (MonthDate), enabling temporal matching to bird tracking data.

8. Annotate Chlorophyll-a for Each Track Point
r
Copy
Edit
frigatebird.tracks$chla <- NA_real_
for (m in unique(frigatebird.tracks$MonthDate)) { ... }
For each monthly date:

Identify which bird GPS points match that month.

Convert those points to spatial coordinates.

Extract the chlorophyll value from the corresponding raster layer.

Append extracted values to a new column chla.

This effectively joins satellite chlorophyll data to each GPS point by space and time.

9. Save Enriched Tracking Data
r
Copy
Edit
saveRDS(frigatebird.tracks, ...)
Stores the enriched dataset with added chlorophyll data for future analysis.

10. Visualize All Tracks (Colored by Bird ID)
r
Copy
Edit
ggplot(...) +
  geom_path(...) +
  scale_color_viridis_d(...)
Plots the movement tracks of all frigatebirds, color-coded by individual tag.

11. Visualize Chlorophyll-a Along One Track
r
Copy
Edit
ggplot(...) +
  geom_path(...) +
  geom_point(aes(fill = log(chla)))
Focuses on a single bird (eobs_9830).

Uses color fill to indicate log-transformed chlorophyll-a at each location.

Highlights how the bird's movement overlaps with areas of high/low productivity.

âœ… What This Code Accomplishes
Downloads and processes MODIS chlorophyll-a data to match bird tracking locations.

Spatially and temporally annotates animal tracks with relevant environmental data.

Creates visualizations to explore how frigatebird movement correlates with ocean productivity.

ðŸŒŽ Why It Matters
This type of workflow is foundational in movement ecology, marine spatial planning, and climate change studies. It helps answer ecological questions like:

Do birds forage in chlorophyll-rich zones?

Are migration patterns shifting with ocean productivity?

How can satellite data guide marine conservation?

